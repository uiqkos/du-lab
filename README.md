# Лабораторная работа по ДУ

## Задание
(10) Нахождение параметров (значений коэффициентов) линейного дифференциального уравнения с постоянными коэффициентами при известных значениях в ряде точек.

## Выполнение
Была выбрана система уравнений:
```
x' = 1/5 * y
y' = 2x - 1/2 * y
```

## Численное решение
С использованием метода NeuralODE были найдены значения коэффициентов при известных значениях в ряде точек.

Процесс обучения в виде динамического графика:

![alt text](assets/gifs/result.gif)


Найденные значения коэффициентов:
```
[[ 1.5477e-03, -2.0322e-01],
[ 1.8768e+00, -4.7752e-01]]
```

Полученная точность - 0.02

В файле `main.py` реализована простая версия NeuralODE из статьи [Neural Ordinary Differential Equations](https://arxiv.org/abs/1806.07366)  


## Применимость алгоритма к разным типам особых точек
Алгоритм был применен к набору уравнений с разными типами особых точек.
### Получение уравнений:
1. HTML код страницы [онлайн калькулятора](https://phapl.github.io/phapl.en.html)
2. Из html достаются уравнения в base64 формате и декодируются в json формат
3. Из json формата достаются уравнения в формате LaTeX и преобразуются в матрицы 2 на 2
4. Для каждой матрицы проводятся 5 экспериментов с обычной матрицей и с нормализованной матрицей
5. Затем сохраняется среднее значение ошибки для каждого уравнения
6. Далее происходит группировка уравнений по типам особых точек

**Результаты эксперимента без нормализации:**

Loss:
```json
{
    "Центр": [
        0.06135363720241003,
        0.40291953763808125,
        0.0001665062489337288,
        0.1439433205407113,
        0.06227285016066162,
        38.45338749885559,
        126.11409492492676,
        1.4243281587958336,
        9596952750.85189,
        92840.64674448967
    ],
    "Неустойчивый узел": [
        318218226892.8042,
        19.41665525501012,
        2815205.0001479103,
        611913092300.8003,
        71.83249621875439,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN
    ],
    "Неустойчивый вырожденный узел": [
        815.4901070352993,
        3.5937299586847073,
        8.203348139976152,
        0.006781069049611688,
        285.7333995084744,
        NaN,
        NaN,
        NaN,
        2.2714822923391933e+24,
        NaN
    ],
    "Устойчивый узел": [
        0.01487696411786601,
        0.0005912519001867623,
        0.0033257661445531992,
        0.00045187788200564685,
        0.0007210602241684682,
        0.00011492910125525669,
        0.00018865884048864246,
        0.0017265619622776284,
        0.00015413269866257907,
        8.981086866697297e-05
    ],
    "Седло": [
        0.0005266423569992185,
        2.921094903475023,
        0.046103120266343466,
        0.0014704054832691328,
        0.01066219639033079,
        1.0104141258800455e+21,
        NaN,
        NaN,
        NaN,
        1.58990795491654e+21
    ],
    "Неустойчивый фокус": [
        0.00642770917766029,
        3.056168090735446,
        0.01968602504930459,
        1104.5063861553149,
        0.36612319168052637,
        6.784990422930796e+20,
        6.507639390164301e+22,
        1.5069408604973695e+21,
        NaN,
        NaN
    ],
    "Центр в линейной системе": [
        0.0001495721546234563,
        65.5928415298462
    ]
}
```

Отклонение весов:
```json
{
    "Центр": [
        0.20418653156733513,
        0.6050478093995154,
        0.23580020727140083,
        0.3452129554220792,
        0.33450814406448603,
        4.155639959964901,
        4.449532417522278,
        2.062854243442416,
        4.187049241922796,
        3.180434597376734
    ],
    "Неустойчивый узел": [
        0.2752994577114135,
        0.27441147556751966,
        0.1951092534700334,
        0.2708180595436692,
        0.3087477087676525,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN
    ],
    "Неустойчивый вырожденный узел": [
        0.2526134374089688,
        0.3553250503612645,
        0.39581378765949604,
        0.2246790062625557,
        0.3077340423476696,
        NaN,
        NaN,
        NaN,
        2.107459208369255,
        NaN
    ],
    "Устойчивый узел": [
        0.3728000461998582,
        0.2895503702019751,
        0.37286720774783194,
        0.25121319423341754,
        0.3059667200685144,
        5.106448029913008,
        3.3832540018483996,
        4.423426864808425,
        2.9657820906490087,
        4.26599677815102
    ],
    "Седло": [
        0.36365424141946434,
        0.3001808147084713,
        0.40485771183001995,
        0.21817016998824476,
        0.42798260669323057,
        2.491095342300832,
        NaN,
        NaN,
        NaN,
        2.9847298951703123
    ],
    "Неустойчивый фокус": [
        0.2985101605222225,
        0.3000050522086024,
        0.08217231340231747,
        0.42677721387505535,
        0.23089841375164688,
        0.8326527368277311,
        2.958635645918548,
        1.5811341129243375,
        NaN,
        NaN
    ],
    "Центр в линейной системе": [
        0.07361932483845204,
        1.7458503340370952
    ]
}
```

**Результаты эксперимента c нормализацией (/max):**

Loss:
```json
{
  "Центр": [
    0.02589100170880556,
    0.09998283628374338,
    0.2127974928007461,
    0.2667751465924084,
    0.0011384612793335692
  ],
  "Неустойчивый узел": [
    715550332948.0416,
    6.757687407198197e+23,
    3.166043676840394e+24,
    76431514031.1923,
    2.4369201288038276e+21
  ],
  "Неустойчивый вырожденный узел": [
    129854305.00833511,
    209483.35497817994,
    8435757.795367012,
    70977942.57872958,
    1.1817111200739812e+18
  ],
  "Устойчивый узел": [
    0.0017452298401622103,
    0.0008046652015764266,
    0.002662430485361256,
    0.0006713342212606221,
    0.0001287930383114144
  ],
  "Седло": [
    9.01165234214859,
    1019754412956.8485,
    1416683664839.2583,
    1953944929212.303,
    1.5715001756878337
  ],
  "Неустойчивый фокус": [
    3.659520207830349e+18,
    5.176618484340259e+25,
    1388706453.686211,
    14801884132.235216,
    43565814253188.63
  ],
  "Центр в линейной системе": [
    0.04756847237003967
  ]
}
```

Отклонение весов:
```json
{
    "Центр": [
        0.13954938693115346,
        0.3557106517255306,
        0.40702366031706333,
        0.39655880366380397,
        0.06333425790071487
    ],
    "Неустойчивый узел": [
        0.6456619139139851,
        0.6093563063070178,
        0.6923121535032988,
        0.43717246130108833,
        0.4790329985693097
    ],
    "Неустойчивый вырожденный узел": [
        0.7311246503693317,
        0.5113031911291183,
        0.5452625658673544,
        0.7612487665067115,
        0.4437970201640079
    ],
    "Устойчивый узел": [
        0.7283369203630302,
        1.229593244396771,
        0.6381918476894497,
        1.2199307354167104,
        0.9970851300749928
    ],
    "Седло": [
        0.7335521968081593,
        0.790334769586722,
        0.8096668332815171,
        0.4630445994436741,
        0.5871810141950846
    ],
    "Неустойчивый фокус": [
        1.0777441657148301,
        2.9564281111583113,
        0.5498707785271109,
        0.6441514573991298,
        0.5753208802392085
    ],
    "Центр в линейной системе": [
        0.19631814400199799
    ]
}
```

**Результаты эксперимента c нормализацией (/10):**

Loss:
```json
{
  "Центр": [
    0.06135363720241003,
    0.40291953763808125,
    0.0001665062489337288,
    0.1439433205407113,
    0.06227285016066162
  ],
  "Неустойчивый узел": [
    318218226892.8042,
    19.41665525501012,
    2815205.0001479103,
    611913092300.8003,
    71.83249621875439
  ],
  "Неустойчивый вырожденный узел": [
    815.4901070352993,
    3.5937299586847073,
    8.203348139976152,
    0.006781069049611688,
    285.7333995084744
  ],
  "Устойчивый узел": [
    0.01487696411786601,
    0.0005912519001867623,
    0.0033257661445531992,
    0.00045187788200564685,
    0.0007210602241684682
  ],
  "Седло": [
    0.0005266423569992185,
    2.921094903475023,
    0.046103120266343466,
    0.0014704054832691328,
    0.01066219639033079
  ],
  "Неустойчивый фокус": [
    0.00642770917766029,
    3.056168090735446,
    0.01968602504930459,
    1104.5063861553149,
    0.36612319168052637
  ],
  "Центр в линейной системе": [
    0.0001495721546234563
  ]
}
```

Отклонение весов:
```json
{
  "Центр": [
    0.20418653156733513,
    0.6050478093995154,
    0.23580020727140083,
    0.3452129554220792,
    0.33450814406448603
  ],
  "Неустойчивый узел": [
    0.2752994577114135,
    0.27441147556751966,
    0.1951092534700334,
    0.2708180595436692,
    0.3087477087676525
  ],
  "Неустойчивый вырожденный узел": [
    0.2526134374089688,
    0.3553250503612645,
    0.39581378765949604,
    0.2246790062625557,
    0.3077340423476696
  ],
  "Устойчивый узел": [
    0.3728000461998582,
    0.2895503702019751,
    0.37286720774783194,
    0.25121319423341754,
    0.3059667200685144
  ],
  "Седло": [
    0.36365424141946434,
    0.3001808147084713,
    0.40485771183001995,
    0.21817016998824476,
    0.42798260669323057
  ],
  "Неустойчивый фокус": [
    0.2985101605222225,
    0.3000050522086024,
    0.08217231340231747,
    0.42677721387505535,
    0.23089841375164688
  ],
  "Центр в линейной системе": [
    0.07361932483845204
  ]
}
```


Можно сделать вывод, что алгоритм хорошо работает с уравнениями с особой точкой "Устойчивый узел" и немного хуже с уравнениями с "Седло" и "Центр". 
Подбор коэффициентов для уравнений показывает достаточно хорошие результаты.

## Выводы
Метод NeuralODE позволяет находить значения коэффициентов линейного дифференциального уравнения с постоянными коэффициентами при известных значениях в ряде точек с достаточно высокой точностью.
